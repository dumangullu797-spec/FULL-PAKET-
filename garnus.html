<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GARNUS</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <style>
      :root {
        --primary-bg: #2b2b2b;
        --secondary-bg: #333;
        --title-bar-bg: #1e1e1e;
        --taskbar-bg: rgba(10, 10, 20, 0.7);
        --text-color: #eee;
        --border-color: #555;
        --window-opacity: 1;
        --taskbar-opacity: 0.7;
      }
      body.theme-light {
        --primary-bg: #f0f0f0;
        --secondary-bg: #fafafa;
        --title-bar-bg: #dcdcdc;
        --taskbar-bg: rgba(240, 240, 240, 0.7);
        --text-color: #333;
        --border-color: #ccc;
      }
      body.theme-ocean {
        --primary-bg: #0d253f;
        --secondary-bg: #0f2d4e;
        --title-bar-bg: #0a1f33;
        --taskbar-bg: rgba(5, 15, 25, 0.7);
        --text-color: #b0c4de;
        --border-color: #1a4a7e;
      }

      body,
      html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        color: white;
        user-select: none;
        background-color: #000;
        cursor: default;
      }
      #boot-sequence-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url("https://images.unsplash.com/photo-1536566482680-fca31930a0bd?q=80&w=2148&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fGVufDB8fHx8fA%3D%3D")
          no-repeat center center fixed;
        background-size: cover;
        z-index: 99999;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }
      #startup-logo {
        font-size: 10vw;
        font-weight: bold;
        color: #fff;
        text-shadow: 0 0 15px #fff, 0 0 25px #4285f4;
        display: none;
      }
      #loading-bar-container {
        width: 40%;
        max-width: 400px;
        height: 5px;
        background-color: #333;
        display: none;
        margin-top: 20px;
      }
      #loading-bar {
        width: 0%;
        height: 100%;
        background-color: #fff;
        box-shadow: 0 0 10px #fff;
      }
      .stutter-load {
        animation: stutterLoad 5s linear forwards;
      }
      @keyframes stutterLoad {
        0% {
          width: 0%;
        }
        10% {
          width: 15%;
        }
        20% {
          width: 17%;
        }
        30% {
          width: 30%;
        }
        40% {
          width: 30%;
        }
        50% {
          width: 55%;
        }
        60% {
          width: 65%;
        }
        70% {
          width: 70%;
        }
        80% {
          width: 72%;
        }
        90% {
          width: 95%;
        }
        100% {
          width: 100%;
        }
      }
      .fade-in-out {
        display: block !important;
        animation: fadeInOut 5s ease-in-out forwards;
      }
      @keyframes fadeInOut {
        0%,
        100% {
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
      }
      #login-screen {
        background-color: rgba(30, 30, 30, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid #555;
        border-radius: 12px;
        padding: 30px;
        width: 500px;
        box-sizing: border-box;
        display: none;
        text-align: center;
      }
      #login-screen i {
        font-size: 80px;
        color: #ccc;
        margin-bottom: 15px;
      }
      #login-screen h2 {
        margin: 0 0 15px 0;
      }
      #password-input {
        width: 80%;
        padding: 12px;
        margin-bottom: 20px;
        border-radius: 5px;
        border: 1px solid #777;
        background-color: #333;
        color: white;
        text-align: center;
        font-size: 18px;
      }
      .next-btn {
        padding: 10px 25px;
        background-color: #4285f4;
        border: none;
        color: white;
        border-radius: 5px;
        cursor: pointer;
      }
      #os-container {
        display: none;
        width: 100%;
        height: 100%;
        animation: desktopFadeIn 1s ease-out forwards;
      }
      @keyframes desktopFadeIn {
        from {
          opacity: 0;
          filter: brightness(0);
        }
        to {
          opacity: 1;
          filter: brightness(1);
        }
      }
      #desktop {
        width: 100%;
        height: calc(100% - 40px);
        position: relative;
        padding: 20px;
        box-sizing: border-box;
        background: url("https://images.unsplash.com/photo-1536566482680-fca31930a0bd?q=80&w=2148&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fGVufDB8fHx8fA%D%3D")
          no-repeat center center fixed;
        background-size: cover;
      }
      .fa-desktop {
        color: #00bcd4;
      }
      .fa-trash-can {
        color: #bdbdbd;
      }
      .fa-folder-open {
        color: #ffca28;
      }
      .fa-pencil {
        color: #ff9800;
      }
      .fa-keyboard {
        color: #e0e0e0;
      }
      .fa-dice-d20 {
        color: #ef5350;
      }
      .fa-hand-pointer {
        color: #42a5f5;
      }
      .fa-gear {
        color: #9e9e9e;
      }
      .fa-brain {
        color: #cf9fff;
      }
      .fa-palette {
        color: #f48fb1;
      }
      .fa-arrow-pointer {
        color: #ffffff;
      }
      .fa-sliders {
        color: #90a4ae;
      }
      .fa-note-sticky {
        color: #fff59d;
      }
      .fa-calculator {
        color: #a5d6a7;
      }
      .fa-chart-line {
        color: #81c784;
      }
      .fa-cloud-sun {
        color: #64b5f6;
      }
      .fa-music {
        color: #ffab91;
      }
      .fa-code {
        color: #80cbc4;
      }
      .fa-terminal {
        color: #aeea00;
      }
      .fa-bug {
        color: #ff7043;
      }
      .fa-hexagon {
        color: #7e57c2;
      }
      .fa-ghost {
        color: #fff176;
      }
      .fa-robot {
        color: #e0e0e0;
      }
      .fa-tower-broadcast {
        color: #f06292;
      }
      .desktop-icon {
        width: 80px;
        text-align: center;
        padding: 10px 0;
        border-radius: 5px;
        transition: background-color 0.2s;
        position: absolute;
        z-index: 100;
      }
      .desktop-icon:hover {
        background-color: rgba(255, 255, 255, 0.15);
        cursor: pointer;
      }
      .desktop-icon i {
        font-size: 36px;
        margin-bottom: 8px;
      }
      .desktop-icon span {
        display: block;
        font-size: 13px;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
        word-wrap: break-word;
      }
      #taskbar {
        width: 100%;
        height: 40px;
        background-color: var(--taskbar-bg);
        backdrop-filter: blur(10px);
        position: fixed;
        bottom: 0;
        left: 0;
        display: flex;
        align-items: center;
        padding: 0 10px;
        box-sizing: border-box;
        z-index: 10000;
        opacity: var(--taskbar-opacity);
        border-top: 1px solid rgba(66, 133, 244, 0.5);
      }
      .start-button {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s;
        border-radius: 4px;
      }
      .start-button .g-logo {
        font-family: "Poppins", sans-serif;
        font-weight: 700;
        font-size: 22px;
        color: #4285f4;
        text-shadow: 1px 1px 1px #000;
      }
      .start-button:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }
      .taskbar-icons {
        display: flex;
        align-items: center;
        margin-left: 10px;
      }
      .taskbar-icons i {
        font-size: 20px;
        margin: 0 8px;
        padding: 5px;
        cursor: pointer;
        transition: background-color 0.2s;
        border-radius: 4px;
      }
      .taskbar-icons i:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }
      #taskbar-apps {
        display: flex;
        align-items: center;
        height: 100%;
        margin-left: 10px;
      }
      .taskbar-app {
        background-color: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 0 10px;
        height: 30px;
        line-height: 30px;
        border-radius: 4px;
        margin: 0 4px;
        font-size: 14px;
        cursor: pointer;
        max-width: 150px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .taskbar-app.active {
        background-color: rgba(66, 133, 244, 0.5);
      }
      .taskbar-app:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }
      .taskbar-center {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        font-size: 14px;
        color: #ccc;
      }
      .system-tray {
        margin-left: auto;
        display: flex;
        align-items: center;
        height: 100%;
      }
      .system-tray i {
        font-size: 16px;
        margin: 0 8px;
        cursor: pointer;
      }
      #clock {
        font-size: 14px;
        padding: 0 10px;
      }
      .window {
        position: absolute;
        top: 100px;
        left: 150px;
        width: 600px;
        height: 400px;
        background-color: var(--primary-bg);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
        resize: both;
        overflow: hidden;
        min-width: 250px;
        min-height: 150px;
        z-index: 1000;
        opacity: var(--window-opacity);
        transition: opacity 0.3s, transform 0.3s;
      }
      .window::before {
        content: "";
        position: absolute;
        top: 30px;
        left: 0;
        width: 100%;
        height: 2px;
        background: #4285f4;
        opacity: 0.6;
        z-index: 1;
      }
      .window-opening {
        transform: scale(0.9);
        opacity: 0;
      }
      .title-bar {
        width: 100%;
        height: 30px;
        background-color: var(--title-bar-bg);
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: move;
        flex-shrink: 0;
        background-image: linear-gradient(
          to bottom,
          rgba(255, 255, 255, 0.08),
          rgba(255, 255, 255, 0)
        );
      }
      .title-bar-text {
        margin-left: 10px;
        font-weight: bold;
        color: var(--text-color);
      }
      .window-controls {
        display: flex;
        margin-right: 5px;
      }
      .window-controls button {
        width: 25px;
        height: 25px;
        border: none;
        background: none;
        color: var(--text-color);
        font-size: 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .window-controls button:hover {
        background-color: rgba(128, 128, 128, 0.2);
      }
      .window-controls .close-btn:hover {
        background-color: #e81123;
        color: white;
      }
      .window-content {
        padding: 15px;
        flex-grow: 1;
        overflow-y: auto;
        background-color: var(--secondary-bg);
        color: var(--text-color);
      }
      .window-content iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
      .window-content ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .window-content li {
        padding: 8px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: grab;
      }
      .window-content li:hover {
        background-color: rgba(128, 128, 128, 0.1);
      }
      .window-content li i {
        margin-right: 10px;
      }
      .delete-file-btn {
        background: none;
        border: none;
        color: #ff6b6b;
        cursor: pointer;
      }
      .store-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px;
        border-bottom: 1px solid var(--border-color);
      }
      .store-item-info {
        display: flex;
        flex-direction: column;
      }
      .store-item-info span {
        font-size: 16px;
        font-weight: bold;
      }
      .store-item-info small {
        color: #bbb;
      }
      .download-btn {
        background-color: #4285f4;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .download-btn:hover {
        background-color: #5a95f5;
      }
      .download-btn:disabled {
        background-color: #555;
        color: #aaa;
        cursor: not-allowed;
      }
      .store-tabs {
        display: flex;
        border-bottom: 1px solid var(--border-color);
      }
      .store-tab {
        padding: 10px 15px;
        cursor: pointer;
      }
      .store-tab.active {
        border-bottom: 2px solid #4285f4;
      }
      .settings-container {
        padding: 0 !important;
      }
      .settings-content {
        padding: 15px;
      }
      .settings-content h3 {
        margin-top: 0;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border-color);
      }
      .background-options {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      .bg-thumbnail {
        width: 100%;
        height: 80px;
        border-radius: 5px;
        cursor: pointer;
        border: 2px solid transparent;
        background-size: cover;
      }
      .bg-thumbnail:hover,
      .bg-thumbnail.active {
        border-color: #4285f4;
      }
      .theme-options button {
        margin-right: 10px;
      }
      #virtual-keyboard {
        position: fixed;
        bottom: 45px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(34, 34, 34, 0.9);
        backdrop-filter: blur(5px);
        padding: 10px;
        border-radius: 8px;
        display: none;
        z-index: 10001;
        cursor: move;
      }
      .keyboard-row {
        display: flex;
        justify-content: center;
      }
      .key {
        background-color: #444;
        color: white;
        border: 1px solid #555;
        border-radius: 4px;
        padding: 10px;
        margin: 2px;
        cursor: pointer;
        min-width: 30px;
        text-align: center;
      }
      .key[data-key="Space"] {
        flex-grow: 5;
      }
      .key[data-key="Backspace"],
      .key[data-key="Enter"] {
        flex-grow: 1.5;
      }
      .key:hover {
        background-color: #666;
      }
      #drawing-app {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: white;
        display: none;
        z-index: 10001;
      }
      #drawing-canvas {
        cursor: crosshair;
        display: block;
      }
      #left-toolbar {
        position: absolute;
        top: 10px;
        left: 10px;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        padding: 10px;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
      }
      #top-right-controls {
        position: absolute;
        top: 10px;
        right: 10px;
        display: flex;
        gap: 10px;
      }
      .tool-button {
        width: 45px;
        height: 45px;
        font-size: 20px;
        border: 1px solid #ccc;
        cursor: pointer;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 5px;
      }
      .tool-button.active {
        background-color: #a0c4ff;
      }
      #color-palette {
        display: flex;
        flex-wrap: wrap;
        width: 50px;
      }
      .color-box {
        width: 20px;
        height: 20px;
        margin: 2px;
        cursor: pointer;
        border: 1px solid #000;
      }
      #start-menu {
        position: fixed;
        bottom: 40px;
        left: 0;
        width: 350px;
        height: 500px;
        background-color: rgba(30, 30, 30, 0.85);
        backdrop-filter: blur(15px);
        border: 1px solid #555;
        border-radius: 8px 8px 0 0;
        display: none;
        flex-direction: column;
        z-index: 9999;
      }
      .start-menu-content {
        padding: 15px;
        flex-grow: 1;
        overflow-y: auto;
      }
      .start-menu-item {
        display: flex;
        align-items: center;
        padding: 10px;
        border-radius: 5px;
        cursor: pointer;
      }
      .start-menu-item:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }
      .start-menu-item i {
        font-size: 20px;
        margin-right: 15px;
        width: 25px;
        text-align: center;
      }
      #start-menu-news a {
        display: block;
        color: #eee;
        text-decoration: none;
        padding: 5px;
        border-radius: 3px;
      }
      #start-menu-news a:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }
      #network-popup {
        position: fixed;
        bottom: 45px;
        right: 10px;
        width: 250px;
        background-color: rgba(40, 40, 40, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        display: none;
        z-index: 9999;
      }
      .chat-container {
        display: flex;
        flex-direction: column;
        height: 100%;
      }
      .chat-messages {
        flex-grow: 1;
        overflow-y: auto;
        padding: 10px;
      }
      .chat-input-form {
        display: flex;
        padding: 10px;
        border-top: 1px solid var(--border-color);
      }
      .chat-input-form input {
        flex-grow: 1;
      }
      .message {
        margin-bottom: 10px;
      }
      .message.user {
        text-align: right;
      }
      .message-bubble {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 15px;
        max-width: 80%;
      }
      .message.user .message-bubble {
        background-color: #4285f4;
      }
      .message.ai .message-bubble {
        background-color: #555;
      }
      .toggle-switch {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
      }
      .terminal-content {
        background: black;
        color: lime;
        height: 100%;
        font-family: monospace;
        padding: 5px;
        overflow-y: auto;
      }
      .terminal-input {
        background: transparent;
        border: none;
        color: lime;
        width: calc(100% - 15px);
      }
      .particle {
        position: fixed;
        width: 5px;
        height: 5px;
        background: white;
        border-radius: 50%;
        pointer-events: none;
        z-index: 99999;
      }
      .error-dialog {
        position: absolute;
        width: 450px;
        background: #f0f0f0;
        border: 1px solid #707070;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        z-index: 9000;
        color: #000;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        font-size: 14px;
        border-radius: 3px;
      }
      .error-title-bar {
        background: #dde7e7;
        padding: 5px 10px;
        color: #000;
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: move;
      }
      .error-content {
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
      }
      .error-icon {
        width: 32px;
        height: 32px;
        background-color: #cc0000;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Segoe UI Symbol", sans-serif;
        font-weight: bold;
        font-size: 20px;
        flex-shrink: 0;
      }
      .error-footer {
        text-align: right;
        padding: 15px;
        background: #f0f0f0;
      }
      .error-footer button {
        padding: 5px 25px;
        border: 1px solid #adadad;
        background-color: #e1e1e1;
      }
    </style>
  </head>
  <body id="body">
    <div id="boot-sequence-container">
      <div id="startup-logo">GARNUS</div>
      <div id="login-screen">
        <i class="fa-solid fa-circle-user"></i>
        <h2>user</h2>
        <input type="password" id="password-input" placeholder="Şifre" /><button
          class="next-btn"
          id="login-btn"
        >
          Giriş Yap
        </button>
      </div>
      <div id="loading-bar-container"><div id="loading-bar"></div></div>
    </div>
    <div id="os-container">
      <div id="desktop"></div>
      <div id="taskbar">
        <div class="start-button"><span class="g-logo">G</span></div>
        <div class="taskbar-icons">
          <i id="pencil-btn" class="fa-solid fa-pencil"></i
          ><i id="keyboard-btn" class="fa-solid fa-keyboard"></i>
        </div>
        <div id="taskbar-apps"></div>
        <div class="taskbar-center">mert tarafından yapıldı</div>
        <div class="system-tray">
          <i id="network-btn" class="fa-solid fa-wifi"></i>
          <div id="clock"></div>
        </div>
      </div>
      <div id="start-menu">
        <div class="start-menu-content">
          <h3>Uygulamalar</h3>
          <div id="start-menu-apps"></div>
          <hr />
          <h3>Haberler</h3>
          <div id="start-menu-news"></div>
        </div>
      </div>
      <div id="network-popup">
        <h4>İnternet Durumu</h4>
        <p>
          <strong>Bağlantı Türü:</strong> <span id="conn-type">Bilinmiyor</span>
        </p>
        <p><strong>Download:</strong> <span id="down-speed">--</span> Mbps</p>
        <p><strong>Upload:</strong> <span id="up-speed">--</span> Mbps</p>
        <small>Not: Hız değerleri simülasyondur.</small>
      </div>
      <div id="drawing-app">
        <canvas id="drawing-canvas"></canvas>
        <div id="left-toolbar">
          <button id="pencil-tool" class="tool-button active" title="Kalem">
            <i class="fa-solid fa-pencil"></i></button
          ><button id="eraser-tool" class="tool-button" title="Silgi">
            <i class="fa-solid fa-eraser"></i></button
          ><button id="clear-canvas-btn" class="tool-button" title="Temizle">
            C</button
          ><input
            type="range"
            id="brush-size"
            min="1"
            max="50"
            value="5"
            title="Fırça Boyutu"
          />
          <div id="color-palette"></div>
        </div>
        <div id="top-right-controls">
          <button id="save-drawing-btn" class="tool-button" title="Kaydet">
            <i class="fa-solid fa-save"></i></button
          ><button id="close-drawing-btn" class="tool-button" title="Kapat">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
      </div>
    </div>
    <div id="virtual-keyboard">
      <div class="keyboard-row">
        <div class="key">1</div>
        <div class="key">2</div>
        <div class="key">3</div>
        <div class="key">4</div>
        <div class="key">5</div>
        <div class="key">6</div>
        <div class="key">7</div>
        <div class="key">8</div>
        <div class="key">9</div>
        <div class="key">0</div>
        <div class="key" data-key="Backspace">
          <i class="fa-solid fa-delete-left"></i>
        </div>
      </div>
      <div class="keyboard-row">
        <div class="key">q</div>
        <div class="key">w</div>
        <div class="key">e</div>
        <div class="key">r</div>
        <div class="key">t</div>
        <div class="key">y</div>
        <div class="key">u</div>
        <div class="key">ı</div>
        <div class="key">o</div>
        <div class="key">p</div>
        <div class="key">/</div>
      </div>
      <div class="keyboard-row">
        <div class="key">a</div>
        <div class="key">s</div>
        <div class="key">d</div>
        <div class="key">f</div>
        <div class="key">g</div>
        <div class="key">h</div>
        <div class="key">j</div>
        <div class="key">k</div>
        <div class="key">l</div>
        <div class="key">.</div>
      </div>
      <div class="keyboard-row">
        <div class="key" data-key="Shift">
          <i class="fa-solid fa-arrow-up"></i>
        </div>
        <div class="key">z</div>
        <div class="key">x</div>
        <div class="key">c</div>
        <div class="key">v</div>
        <div class="key">b</div>
        <div class="key">n</div>
        <div class="key">m</div>
        <div class="key">,</div>
        <div class="key" data-key="Enter">Enter</div>
      </div>
      <div class="keyboard-row"><div class="key" data-key="Space"></div></div>
    </div>

    <script>
      const bootContainer = document.getElementById("boot-sequence-container");
      const logo = document.getElementById("startup-logo");
      const loginScreen = document.getElementById("login-screen");
      const osContainer = document.getElementById("os-container");
      const passwordInput = document.getElementById("password-input");
      const loadingBarContainer = document.getElementById(
        "loading-bar-container"
      );
      const loadingBar = document.getElementById("loading-bar");

      function playLogoAnimation(callback) {
        logo.classList.add("fade-in-out");
        setTimeout(() => {
          logo.classList.remove("fade-in-out");
          if (callback) callback();
        }, 5000);
      }
      if (localStorage.getItem("isGOSInstalled") === "true") {
        bootContainer.style.display = "none";
        osContainer.style.display = "block";
      } else {
        playLogoAnimation(() => {
          loginScreen.style.display = "block";
        });
      }

      const loginHandler = () => {
        if (passwordInput.value.toLowerCase() === "mert") {
          localStorage.setItem("isGOSInstalled", "true");
          virtualKeyboard.style.display = "none";
          loginScreen.style.display = "none";
          logo.style.display = "block";
          loadingBarContainer.style.display = "block";
          loadingBar.classList.add("stutter-load");
          setTimeout(() => {
            bootContainer.style.display = "none";
            osContainer.style.display = "block";
          }, 5000);
        } else {
          alert("Hatalı şifre!");
          passwordInput.value = "";
        }
      };
      document
        .getElementById("login-btn")
        .addEventListener("click", loginHandler);
      passwordInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") loginHandler();
      });

      const desktop = document.getElementById("desktop");
      let highestZIndex = 1000;
      let installedAppCount = 0;
      let files = [];
      let installedApps =
        JSON.parse(localStorage.getItem("gos_installed")) || [];
      const icons = [
        {
          name: "sistem",
          icon: "fa-solid fa-desktop",
          action: openSystemInfoWindow,
        },
        {
          name: "çöp kutusu",
          icon: "fa-solid fa-trash-can",
          action: openTrashWindow,
        },
        {
          name: "dosyalar",
          icon: "fa-solid fa-folder-open",
          action: openFilesWindow,
        },
        {
          name: "crhome",
          icon: "fa-brands fa-chrome",
          color: "#4285F4",
          action: () =>
            createWebWindow("https://www.google.com/webhp?igu=1", "Crhome"),
        },
        {
          name: "mağaza",
          icon: "fa-solid fa-store",
          color: "#8A63D2",
          action: openStoreWindow,
        },
        {
          name: "ayarlar",
          icon: "fa-solid fa-gear",
          action: openSettingsWindow,
        },
      ];
      const newsData = [
        {
          title: "Yeni GARNUS Sürümü Yayınlandı!",
          url: "https://www.google.com/search?q=yeni+işletim+sistemi+sürümleri",
        },
        {
          title: "Teknoloji Devi, Yeni Yapay Zeka Modelini Tanıttı",
          url: "https://www.google.com/search?q=yeni+yapay+zeka+modelleri",
        },
        {
          title: "HTML6 Standartları Üzerine Çalışmalar Başladı",
          url: "https://www.google.com/search?q=html6+nedir",
        },
      ];
      const gameData = [
        {
          id: "2048",
          name: "2048",
          action: () => createWebWindow("https://play2048.co/", "2048"),
          icon: "fa-solid fa-border-all",
          desc: "Sayıları birleştirerek 2048'e ulaş.",
        },
        {
          id: "hextris",
          name: "Hextris",
          action: () => createWebWindow("https://hextris.io/", "Hextris"),
          icon: "fa-solid fa-hexagon",
          desc: "Dönen altıgeni bloklarla doldurma.",
        },
        {
          id: "pacman",
          name: "Pac-Man",
          action: () => createWebWindow("https://pacman.live/", "Pac-Man"),
          icon: "fa-solid fa-ghost",
          desc: "Klasik atari oyunu.",
        },
        {
          id: "dino",
          name: "Dino Game",
          action: () => createWebWindow("https://dino-game.com/", "Dino Game"),
          icon: "fa-solid fa-robot",
          desc: "Engellerin üzerinden atla.",
        },
        {
          id: "tower-defense",
          name: "Tower Defense",
          action: () =>
            createWebWindow(
              "https://www.bestgames.com/Tower-Defense",
              "Tower Defense"
            ),
          icon: "fa-solid fa-tower-broadcast",
          desc: "Kulelerini kur ve düşmanı durdur.",
        },
      ];
      const appData = [
        {
          id: "gemini-asistan",
          name: "Gemini Asistan",
          action: openAIAssistant,
          icon: "fa-solid fa-brain",
          desc: "Yapay zeka ile sohbet edin.",
        },
        {
          id: "theme-manager",
          name: "Tema Yöneticisi",
          action: openThemeManager,
          icon: "fa-solid fa-palette",
          desc: "Arayüz ve arka planı özelleştirin.",
        },
        {
          id: "cursor-styler",
          name: "İmleç Stilleri",
          action: openCursorStyler,
          icon: "fa-solid fa-arrow-pointer",
          desc: "Fare imlecinizi değiştirin.",
        },
        {
          id: "interface-settings",
          name: "Arayüz Ayarları",
          action: openInterfaceSettings,
          icon: "fa-solid fa-sliders",
          desc: "Pencere şeffaflığını ayarlayın.",
        },
        {
          id: "notepad",
          name: "Not Defteri",
          action: openNotepad,
          icon: "fa-solid fa-note-sticky",
          desc: "Basit metinler oluşturun ve kaydedin.",
        },
        {
          id: "calculator",
          name: "Hesap Makinesi",
          action: openCalculator,
          icon: "fa-solid fa-calculator",
          desc: "Dört işlem yapın.",
        },
        {
          id: "system-monitor",
          name: "Sistem Gözlemcisi",
          action: openSystemMonitor,
          icon: "fa-solid fa-chart-line",
          desc: "Sistem kullanımını izleyin.",
        },
        {
          id: "weather",
          name: "Hava Durumu",
          action: openWeather,
          icon: "fa-solid fa-cloud-sun",
          desc: "Canlı hava durumu bilgisi alın.",
        },
        {
          id: "music-player",
          name: "Müzik Çalar",
          action: openMusicPlayer,
          icon: "fa-solid fa-music",
          desc: "Rahatlatıcı müzikler dinleyin.",
        },
        {
          id: "code-editor",
          name: "Kod Düzenleyici",
          action: openCodeEditor,
          icon: "fa-solid fa-code",
          desc: "Basit kodlar yazın.",
        },
        {
          id: "terminal",
          name: "Terminal",
          action: openTerminal,
          icon: "fa-solid fa-terminal",
          desc: "Komut satırı arayüzü.",
        },
        {
          id: "error-test",
          name: "Hata Testi",
          action: openErrorTestApp,
          icon: "fa-solid fa-bug",
          desc: "Rastgele sistem hataları oluşturun.",
        },
      ];
      icons.forEach((item, index) => {
        createDesktopIcon(
          `icon-${item.name}`,
          item.name,
          item.icon,
          item.action,
          item.color,
          index
        );
      });

      function populateNews() {
        const c = document.getElementById("start-menu-news");
        c.innerHTML = "";
        newsData.forEach((n) => {
          c.innerHTML += `<a href="${n.url}" target="_blank">${n.title}</a>`;
        });
      }
      function createDesktopIcon(
        id,
        name,
        iconClass,
        action,
        color,
        index,
        pos
      ) {
        const i = document.createElement("div");
        i.className = "desktop-icon";
        i.id = id;
        i.innerHTML = `<i class="${iconClass}" style="${
          color ? `color:${color}` : ""
        }"></i><span>${name}</span>`;
        if (pos) {
          i.style.top = `${pos.y}px`;
          i.style.left = `${pos.x}px`;
        } else if (index !== undefined) {
          i.style.top = `${20 + index * 100}px`;
          i.style.left = `20px`;
        } else {
          i.style.top = `${20 + installedAppCount * 100}px`;
          i.style.right = `20px`;
          installedAppCount++;
        }
        i.addEventListener("dblclick", action);
        makeElementDraggable(i);
        desktop.appendChild(i);
      }
      function updateClock() {
        const n = new Date();
        const h = String(n.getHours()).padStart(2, "0");
        const m = String(n.getMinutes()).padStart(2, "0");
        document.getElementById("clock").textContent = `${h}:${m}`;
      }
      setInterval(updateClock, 1000);
      updateClock();
      populateNews();
      function createWindow(t, c, o) {
        highestZIndex++;
        const w = document.createElement("div");
        w.className = "window";
        const wId = "window-" + Date.now();
        w.id = wId;
        w.style.zIndex = highestZIndex;
        if (localStorage.getItem("gos_animations") === "true") {
          w.classList.add("window-opening");
          setTimeout(() => w.classList.remove("window-opening"), 300);
        }
        w.innerHTML = `<div class="title-bar"><span class="title-bar-text">${t}</span><div class="window-controls"><button class="minimize-btn" title="Simge Durumuna Küçült"><i class="fa-solid fa-window-minimize"></i></button><button class="maximize-btn" title="Ekranı Kapla"><i class="fa-regular fa-clone"></i></button><button class="close-btn" title="Kapat"><i class="fa-solid fa-times"></i></button></div></div><div class="window-content ${
          t === "Ayarlar" ? "settings-container" : ""
        }" style="${
          ["Crhome", "Hava Durumu"].includes(t) ||
          gameData.some((g) => g.name === t) ||
          t.startsWith("Görüntü")
            ? "padding:0; overflow:hidden;"
            : ""
        }">${c}</div>`;
        desktop.appendChild(w);
        makeElementDraggable(w, w.querySelector(".title-bar"));
        const a = document.createElement("div");
        a.className = "taskbar-app active";
        a.textContent = t;
        a.dataset.windowId = wId;
        document.getElementById("taskbar-apps").appendChild(a);
        a.addEventListener("click", () => toggleMinimize(wId));
        const b = () => {
          highestZIndex++;
          w.style.zIndex = highestZIndex;
          document
            .querySelectorAll(".taskbar-app")
            .forEach((x) => x.classList.remove("active"));
          a.classList.add("active");
        };
        w.addEventListener("mousedown", b);
        w.querySelector(".close-btn").addEventListener("click", () => {
          w.remove();
          a.remove();
        });
        w.querySelector(".minimize-btn").addEventListener("click", () =>
          toggleMinimize(wId, true)
        );
        const m = w.querySelector(".maximize-btn");
        let i = false;
        let s = {};
        m.addEventListener("click", () => {
          if (!i) {
            s = {
              top: w.style.top,
              left: w.style.left,
              width: w.style.width,
              height: w.style.height,
            };
            w.style.top = "0";
            w.style.left = "0";
            w.style.width = "100%";
            w.style.height = "calc(100% - 40px)";
            w.style.resize = "none";
            i = true;
          } else {
            w.style.top = s.top;
            w.style.left = s.left;
            w.style.width = s.width;
            w.style.height = s.height;
            w.style.resize = "both";
            i = false;
          }
        });
        if (o) {
          o(w);
        }
        b();
        return w;
      }
      function toggleMinimize(wId, f = false) {
        const w = document.getElementById(wId);
        const a = document.querySelector(
          `.taskbar-app[data-window-id="${wId}"]`
        );
        if (!w) return;
        if (w.style.display !== "none" && f) {
          w.style.display = "none";
          a.classList.remove("active");
        } else if (
          w.style.display !== "none" &&
          !f &&
          w.style.zIndex == highestZIndex
        ) {
          w.style.display = "none";
          a.classList.remove("active");
        } else {
          w.style.display = "flex";
          highestZIndex++;
          w.style.zIndex = highestZIndex;
          document
            .querySelectorAll(".taskbar-app")
            .forEach((x) => x.classList.remove("active"));
          a.classList.add("active");
        }
      }
      function createWebWindow(u, t) {
        const c = `<iframe src="${u}"></iframe>`;
        createWindow(t, c);
      }
      function openSystemInfoWindow() {
        const c = `<h3>Sistem Bilgileri</h3><p><strong>İşlemci Çekirdek Sayısı:</strong> ${
          navigator.hardwareConcurrency || "N/A"
        }</p><p><strong>RAM:</strong> ${
          navigator.deviceMemory
            ? `${navigator.deviceMemory} GB (Yaklaşık)`
            : "N/A"
        }</p><p><strong>Ekran Kartı:</strong> Tarayıcı güvenlik kısıtlamaları nedeniyle bu bilgi alınamaz.</p>`;
        createWindow("Sistem Bilgileri", c);
      }
      function openFilesWindow() {
        const w = createWindow("Dosyalar", "<ul></ul>");
        renderFiles(w);
      }
      function renderFiles(w) {
        const u = w.querySelector("ul");
        u.innerHTML = "";
        files.forEach((f) => {
          const l = document.createElement("li");
          let i = "fa-file";
          if (f.type === "folder") i = "fa-folder";
          if (f.type === "image") i = "fa-file-image";
          if (f.type === "shortcut") i = f.icon;
          l.innerHTML = `<i class="fa-solid ${i}"></i> ${f.name}`;
          if (f.type === "shortcut") {
            l.draggable = true;
            l.dataset.fileId = f.id;
            l.ondragstart = (e) => {
              e.dataTransfer.setData("text/plain", f.id);
            };
          }
          l.addEventListener("dblclick", () => {
            if (f.type === "image") {
              const c = `<img src="${f.content}" style="width:100%; height:100%; object-fit:contain;">`;
              createWindow(`Görüntüleyici - ${f.name}`, c);
            }
            if (f.type === "text") {
              openNotepad(f.content);
            }
            if (f.type === "shortcut") {
              f.action();
            }
          });
          u.appendChild(l);
        });
      }
      function openTrashWindow() {
        const w = createWindow("Çöp Kutusu", "<ul></ul>");
        renderTrash(w);
      }
      function renderTrash(w) {
        const u = w.querySelector("ul");
        u.innerHTML = "";
        trash.forEach((f, i) => {
          const l = document.createElement("li");
          l.innerHTML = `<span><i class="fa-solid fa-file"></i> ${f.name}</span><button class="delete-file-btn" data-index="${i}"><i class="fa-solid fa-trash-can"></i> Kalıcı Olarak Sil</button>`;
          u.appendChild(l);
        });
        u.querySelectorAll(".delete-file-btn").forEach((b) => {
          b.addEventListener("click", (e) => {
            trash.splice(e.currentTarget.dataset.index, 1);
            renderTrash(w);
          });
        });
      }
      function makeElementDraggable(e, h) {
        let p1 = 0,
          p2 = 0,
          p3 = 0,
          p4 = 0;
        const dH = h || e;
        dH.onmousedown = (ev) => {
          ev.preventDefault();
          p3 = ev.clientX;
          p4 = ev.clientY;
          document.onmouseup = () => {
            document.onmouseup = null;
            document.onmousemove = null;
          };
          document.onmousemove = (ev) => {
            ev.preventDefault();
            p1 = p3 - ev.clientX;
            p2 = p4 - ev.clientY;
            p3 = ev.clientX;
            p4 = ev.clientY;
            e.style.top = e.offsetTop - p2 + "px";
            e.style.left = e.offsetLeft - p1 + "px";
          };
        };
      }
      const keyboardBtn = document.getElementById("keyboard-btn");
      const virtualKeyboard = document.getElementById("virtual-keyboard");
      let isShift = false;
      keyboardBtn.addEventListener("click", () => {
        virtualKeyboard.style.display =
          virtualKeyboard.style.display === "block" ? "none" : "block";
      });
      makeElementDraggable(virtualKeyboard);
      document.addEventListener("focusin", (e) => {
        if (
          e.target.matches("input:not([type=range]), textarea") &&
          !e.target.closest("#virtual-keyboard")
        ) {
          virtualKeyboard.style.display = "block";
        }
      });
      document.querySelectorAll("#virtual-keyboard .key").forEach((k) => {
        k.addEventListener("click", (e) => {
          const target = document.activeElement;
          if (!target.matches("input:not([type=range]), textarea")) return;
          const key = k.dataset.key || k.textContent;
          if (key === "Backspace") {
            target.value = target.value.slice(0, -1);
          } else if (key === "Enter") {
            if (target.tagName === "TEXTAREA") target.value += "\n";
            else
              target.closest("form")?.submit() ||
                target.dispatchEvent(
                  new KeyboardEvent("keydown", { key: "Enter" })
                );
          } else if (key === "Space") {
            target.value += " ";
          } else if (key === "Shift") {
            isShift = !isShift;
            virtualKeyboard.querySelectorAll(".key").forEach((keyEl) => {
              if (keyEl.textContent.length === 1)
                keyEl.textContent = isShift
                  ? keyEl.textContent.toUpperCase()
                  : keyEl.textContent.toLowerCase();
            });
          } else {
            target.value += k.textContent;
          }
          target.focus();
        });
      });
      const drawingApp = document.getElementById("drawing-app");
      const canvas = document.getElementById("drawing-canvas");
      const ctx = canvas.getContext("2d");
      let isDrawing = false;
      const pencilTool = document.getElementById("pencil-tool");
      const eraserTool = document.getElementById("eraser-tool");
      const colors = [
        "#000000",
        "#FF0000",
        "#00FF00",
        "#0000FF",
        "#FFFF00",
        "#FF00FF",
        "#00FFFF",
        "#FFFFFF",
      ];
      const colorPalette = document.getElementById("color-palette");
      colors.forEach((c) => {
        const b = document.createElement("div");
        b.className = "color-box";
        b.style.backgroundColor = c;
        b.addEventListener("click", () => {
          ctx.strokeStyle = c;
          pencilTool.click();
        });
        colorPalette.appendChild(b);
      });
      document.getElementById("pencil-btn").addEventListener("click", () => {
        drawingApp.style.display = "block";
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.lineCap = "round";
        ctx.lineWidth = document.getElementById("brush-size").value;
        ctx.strokeStyle = "#000000";
        pencilTool.click();
      });
      document
        .getElementById("close-drawing-btn")
        .addEventListener("click", () => {
          drawingApp.style.display = "none";
        });
      pencilTool.addEventListener("click", () => {
        ctx.globalCompositeOperation = "source-over";
        pencilTool.classList.add("active");
        eraserTool.classList.remove("active");
      });
      eraserTool.addEventListener("click", () => {
        ctx.globalCompositeOperation = "destination-out";
        eraserTool.classList.add("active");
        pencilTool.classList.remove("active");
      });
      document
        .getElementById("clear-canvas-btn")
        .addEventListener("click", () =>
          ctx.clearRect(0, 0, canvas.width, canvas.height)
        );
      document
        .getElementById("brush-size")
        .addEventListener("input", (e) => (ctx.lineWidth = e.target.value));
      document
        .getElementById("save-drawing-btn")
        .addEventListener("click", () => {
          const n = `cizim-${Date.now()}.png`;
          const d = canvas.toDataURL("image/png");
          files.push({ id: Date.now(), name: n, type: "image", content: d });
          alert(`"${n}" dosyası "Dosyalar" uygulamasına kaydedildi!`);
          drawingApp.style.display = "none";
          document.querySelectorAll(".window").forEach((w) => {
            if (
              w.querySelector(".title-bar-text")?.textContent === "Dosyalar"
            ) {
              renderFiles(w);
            }
          });
        });
      canvas.addEventListener("mousedown", (e) => {
        isDrawing = true;
        draw(e);
      });
      canvas.addEventListener("mouseup", () => {
        isDrawing = false;
        ctx.beginPath();
      });
      canvas.addEventListener("mousemove", (e) => {
        if (!isDrawing) return;
        ctx.lineTo(e.clientX, e.clientY);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(e.clientX, e.clientY);
      });
      const startBtn = document.querySelector("#os-container .start-button");
      const startMenu = document.getElementById("start-menu");
      const startMenuApps = document.getElementById("start-menu-apps");
      icons.forEach((i) => {
        const t = document.createElement("div");
        t.className = "start-menu-item";
        t.innerHTML = `<i class="${i.icon}" style="${
          i.color ? `color:${i.color}` : ""
        }"></i><span>${i.name}</span>`;
        t.onclick = () => {
          i.action();
          startMenu.style.display = "none";
        };
        startMenuApps.appendChild(t);
      });
      startBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        startMenu.style.display =
          startMenu.style.display === "flex" ? "none" : "flex";
      });
      document.addEventListener("click", (e) => {
        if (
          !startMenu.contains(e.target) &&
          e.target !== startBtn &&
          !startBtn.contains(e.target)
        ) {
          startMenu.style.display = "none";
        }
      });
      const networkBtn = document.getElementById("network-btn");
      const networkPopup = document.getElementById("network-popup");
      networkBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        const i = networkPopup.style.display === "block";
        if (!i) {
          document.getElementById("conn-type").textContent =
            navigator.connection?.type || "Wi-Fi";
          document.getElementById("down-speed").textContent = (
            Math.random() * (100 - 20) +
            20
          ).toFixed(2);
          document.getElementById("up-speed").textContent = (
            Math.random() * (20 - 5) +
            5
          ).toFixed(2);
        }
        networkPopup.style.display = i ? "none" : "block";
      });
      document.addEventListener("click", (e) => {
        if (!networkPopup.contains(e.target) && e.target !== networkBtn) {
          networkPopup.style.display = "none";
        }
      });
      function openStoreWindow() {
        let gH = "";
        let aH = "";
        [...appData, ...gameData].forEach((g) => {
          const i = installedApps.includes(g.id);
          const a = appData.includes(g) ? `, '${g.id}'` : "";
          const d = `<div class="store-item"><div class="store-item-info"><span><i class="${
            g.icon
          }"></i> ${g.name}</span><small>${
            g.desc
          }</small></div><button id="download-btn-${
            g.id
          }" class="download-btn" onclick="installApp('${g.id}', '${
            g.name
          }', null, '${g.icon}'${a})" ${i ? "disabled" : ""}>${
            i ? "Yüklendi" : "İndir"
          }</button></div>`;
          if (gameData.includes(g)) gH += d;
          else aH += d;
        });
        const c = `<div class="store-tabs"><div class="store-tab active" onclick="switchStoreTab(this, 'games')">Oyunlar</div><div class="store-tab" onclick="switchStoreTab(this, 'apps')">Uygulamalar</div></div><div id="store-games">${gH}</div><div id="store-apps" style="display:none">${aH}</div>`;
        createWindow("Mağaza", c);
      }
      function switchStoreTab(el, tab) {
        document.querySelector(".store-tab.active").classList.remove("active");
        el.classList.add("active");
        document.getElementById("store-games").style.display =
          tab === "games" ? "block" : "none";
        document.getElementById("store-apps").style.display =
          tab === "apps" ? "block" : "none";
      }
      function installApp(id, name, action, icon, actionId) {
        if (installedApps.includes(id)) return;
        const appAction = actionId
          ? appData.find((a) => a.id === actionId).action
          : gameData.find((g) => g.id === id).action;
        files.push({
          id: id,
          name: name,
          type: "shortcut",
          icon: icon,
          action: appAction,
        });
        installedApps.push(id);
        localStorage.setItem("gos_installed", JSON.stringify(installedApps));
        alert(`"${name}" Dosyalar'a indirildi!`);
        const b = document.getElementById(`download-btn-${id}`);
        if (b) {
          b.disabled = true;
          b.textContent = "Yüklendi";
        }
        document.querySelectorAll(".window").forEach((w) => {
          if (w.querySelector(".title-bar-text")?.textContent === "Dosyalar") {
            renderFiles(w);
          }
        });
      }
      desktop.ondragover = (e) => e.preventDefault();
      desktop.ondrop = (e) => {
        e.preventDefault();
        const id = e.dataTransfer.getData("text/plain");
        const fileIndex = files.findIndex((f) => f.id == id);
        if (fileIndex > -1) {
          const file = files[fileIndex];
          if (
            file.type === "shortcut" &&
            !document.getElementById(`icon-${file.id}`)
          ) {
            createDesktopIcon(
              `icon-${file.id}`,
              file.name,
              file.icon,
              file.action,
              null,
              undefined,
              { x: e.clientX, y: e.clientY }
            );
            files.splice(fileIndex, 1);
            document.querySelectorAll(".window").forEach((w) => {
              if (
                w.querySelector(".title-bar-text")?.textContent === "Dosyalar"
              ) {
                renderFiles(w);
              }
            });
          }
        }
      };
      const backgrounds = [
        "https://images.unsplash.com/photo-1536566482680-fca31930a0bd?q=80&w=2148&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fGVufDB8fHx8fA%3D%3D",
        "https://images.unsplash.com/photo-1447433589675-4aaa569f3e05?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fGVufDB8fHx8fA%3D%3D",
        "https://images.unsplash.com/photo-1487088678257-3a541e6e3922?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fGVufDB8fHx8fA%3D%3D",
        "https://images.unsplash.com/photo-1506318137071-a8e063b4bec0?q=80&w=2093&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fGVufDB8fHx8fA%3D%3D",
      ];
      function openSettingsWindow() {
        const c = `<div class="settings-content"><h3>Görünüm</h3><div class="toggle-switch"><span>Pencere Animasyonları</span><input type="checkbox" onchange="toggleSetting('animations', this.checked)" ${
          localStorage.getItem("gos_animations") === "true" ? "checked" : ""
        }></div><hr><h3>Erişilebilirlik</h3><div class="toggle-switch"><span>İmleç Efektleri</span><input type="checkbox" onchange="toggleSetting('cursorEffects', this.checked)" ${
          localStorage.getItem("gos_cursorEffects") === "true" ? "checked" : ""
        }></div><div class="toggle-switch"><span>Arayüz Sesleri</span><input type="checkbox" onchange="toggleSetting('sounds', this.checked)" ${
          localStorage.getItem("gos_sounds") === "true" ? "checked" : ""
        }></div><hr><h3>Sistem</h3><p>Cihaz Adı: GARNUS-PC</p><p>Sürüm: BetaZ9</p><button class="next-btn" onclick="resetSettings()">GARNUS'u Sıfırla</button></div>`;
        createWindow("Ayarlar", c);
      }
      function changeBackground(u) {
        desktop.style.backgroundImage = `url('${u}')`;
        bootContainer.style.backgroundImage = `url('${u}')`;
        localStorage.setItem("gos_background", u);
      }
      function changeTheme(t) {
        document.body.className =
          t === "light" ? "theme-light" : t === "ocean" ? "theme-ocean" : "";
        localStorage.setItem("gos_theme", t);
      }
      function resetSettings() {
        localStorage.clear();
        alert("Ayarlar sıfırlandı. Sistem yeniden başlatılıyor.");
        location.reload();
      }
      function applySavedSettings() {
        const b = localStorage.getItem("gos_background");
        const t = localStorage.getItem("gos_theme");
        if (b) changeBackground(b);
        if (t) changeTheme(t);
        toggleSetting(
          "cursorEffects",
          localStorage.getItem("gos_cursorEffects") === "true"
        );
        toggleSetting("sounds", localStorage.getItem("gos_sounds") === "true");
      }
      applySavedSettings();
      function toggleSetting(s, e) {
        localStorage.setItem("gos_" + s, e);
        if (s === "cursorEffects") {
          if (e) document.addEventListener("mousemove", cursorEffectHandler);
          else document.removeEventListener("mousemove", cursorEffectHandler);
        }
        if (s === "sounds") {
          if (e) document.addEventListener("click", soundEffectHandler);
          else document.removeEventListener("click", soundEffectHandler);
        }
      }
      function cursorEffectHandler(e) {
        let p = document.createElement("div");
        p.className = "particle";
        document.body.appendChild(p);
        p.style.left = e.clientX + "px";
        p.style.top = e.clientY + "px";
        let a = [
          { transform: "scale(1)", opacity: 1 },
          { transform: "scale(2)", opacity: 0 },
        ];
        p.animate(a, 1000);
        setTimeout(() => p.remove(), 1000);
      }
      const clickSound = new Audio(
        "data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU" +
          Array(30).join("127,")
      );
      function soundEffectHandler() {
        clickSound.currentTime = 0;
        clickSound.play();
      }
      function openAIAssistant() {
        const c = `<div class="chat-container"><div class="chat-messages"><div class="message ai"><div class="message-bubble">Merhaba, ben Gemini Asistan. Size nasıl yardımcı olabilirim?</div></div></div><form class="chat-input-form"><input type="text" placeholder="Bir mesaj yazın..." required><button type="submit" class="next-btn">Gönder</button></form></div>`;
        createWindow("Gemini Asistan", c, (w) => {
          const f = w.querySelector("form");
          const i = f.querySelector("input");
          const m = w.querySelector(".chat-messages");
          f.addEventListener("submit", (e) => {
            e.preventDefault();
            const q = i.value;
            if (!q) return;
            m.innerHTML += `<div class="message user"><div class="message-bubble">${q}</div></div>`;
            i.value = "";
            m.scrollTop = m.scrollHeight;
            setTimeout(() => {
              m.innerHTML += `<div class="message ai"><div class="message-bubble">Elbette, "${q}" ile ilgili Google'da bulduğum bazı sonuçlar şunlar: <hr><iframe src="https://www.google.com/search?igu=1&q=${encodeURIComponent(
                q
              )}" style="width:100%; height:200px; border-radius:10px; margin-top:10px;"></iframe></div></div>`;
              m.scrollTop = m.scrollHeight;
            }, 1000);
          });
        });
      }
      function openThemeManager() {
        let h = "";
        backgrounds.forEach((b) => {
          h += `<div class="bg-thumbnail" style="background-image: url('${b}')" onclick="changeBackground('${b}')"></div>`;
        });
        const c = `<div class="settings-content"><h3>Arka Plan Galerisi</h3><div class="background-options">${h}</div><hr><h3>Arayüz Renkleri</h3><div class="theme-options"><button class="next-btn" onclick="changeTheme('')">Koyu</button><button class="next-btn" onclick="changeTheme('light')">Açık</button><button class="next-btn" onclick="changeTheme('ocean')">Okyanus</button></div></div>`;
        createWindow("Tema Yöneticisi", c);
      }
      function openCursorStyler() {
        const cursors = ["default", "pointer", "crosshair", "wait", "text"];
        let h = "";
        cursors.forEach((c) => {
          h += `<button class="next-btn" style="cursor:${c}" onclick="changeCursor('${c}')">${c}</button> `;
        });
        const c = `<div class="settings-content"><h3>İmleç Seç</h3>${h}</div>`;
        createWindow("İmleç Stilleri", c);
      }
      function changeCursor(c) {
        document.body.style.cursor = c;
      }
      function openInterfaceSettings() {
        const c = `<div class="settings-content"><h3>Şeffaflık</h3><label>Pencere</label><input type="range" min="0.5" max="1" step="0.05" value="1" oninput="changeOpacity(this, '--window-opacity')"><br><label>Görev Çubuğu</label><input type="range" min="0.3" max="1" step="0.05" value="0.7" oninput="changeOpacity(this, '--taskbar-opacity')"></div>`;
        createWindow("Arayüz Ayarları", c);
      }
      function changeOpacity(el, v) {
        document.documentElement.style.setProperty(v, el.value);
      }
      function openNotepad(content = "") {
        const c = `<textarea style="width:100%;height:calc(100% - 40px);resize:none;box-sizing:border-box;"></textarea><button class="next-btn" style="margin-top:5px;">Dosyalar'a Kaydet</button>`;
        createWindow("Not Defteri", c, (w) => {
          const t = w.querySelector("textarea");
          t.value = content;
          w.querySelector("button").onclick = () => {
            const n = prompt("Dosya adı:", "not.txt");
            if (n) {
              files.push({
                id: Date.now(),
                name: n,
                type: "text",
                content: t.value,
              });
              alert("Kaydedildi!");
            }
          };
        });
      }
      function openCalculator() {
        const c = `<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:5px;height:100%;"><input id="calc-display" readonly style="grid-column:1/-1;text-align:right;padding:10px;font-size:24px;"><button>7</button><button>8</button><button>9</button><button>/</button><button>4</button><button>5</button><button>6</button><button>*</button><button>1</button><button>2</button><button>3</button><button>-</button><button>0</button><button>.</button><button class="next-btn">=</button><button>+</button></div>`;
        createWindow("Hesap Makinesi", c, (w) => {
          const d = w.querySelector("#calc-display");
          w.querySelectorAll("button").forEach((b) => {
            b.onclick = () => {
              try {
                if (b.textContent === "=") {
                  d.value = eval(d.value.replace(/[^-()\d/*+.]/g, ""));
                } else {
                  d.value += b.textContent;
                }
              } catch (e) {
                d.value = "Hata";
              }
            };
          });
        });
      }
      function openSystemMonitor() {
        const c = `<div>CPU Kullanımı</div><canvas id="cpu-chart" height="100"></canvas><div>RAM Kullanımı</div><canvas id="ram-chart" height="100"></canvas>`;
        createWindow("Sistem Gözlemcisi", c, (w) => {
          ["cpu-chart", "ram-chart"].forEach((id) => {
            const ctx = w.querySelector(`#${id}`).getContext("2d");
            setInterval(() => {
              ctx.clearRect(0, 0, 300, 100);
              ctx.fillStyle = "green";
              ctx.fillRect(0, 0, Math.random() * 300, 100);
            }, 500);
          });
        });
      }
      function openWeather() {
        createWebWindow(
          "https://www.meteoblue.com/tr/hava/widget/daily/istanbul_t%c3%bcrkiye_745044?geoloc=fixed&days=4&tempunit=CELSIUS&windunit=KILOMETER_PER_HOUR&precipunit=MILLIMETER&coloured=coloured&pictoicon=0&pictoicon=1&maxtemperature=0&maxtemperature=1&mintemperature=0&mintemperature=1&windspeed=0&windspeed=1&windgust=0&winddirection=0&winddirection=1&uv=0&humidity=0&precipitation=0&precipitation=1&precipitationprobability=0&precipitationprobability=1&spot=0&pressure=0&layout=light",
          "Hava Durumu"
        );
      }
      function openMusicPlayer() {
        const c = `<h3>Müzik Çalar</h3><audio controls src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>`;
        createWindow("Müzik Çalar", c);
      }
      function openCodeEditor() {
        const c = `<textarea style="width:100%;height:100%;resize:none;box-sizing:border-box;background:#1e1e1e;color:#d4d4d4;font-family:monospace;"></textarea>`;
        createWindow("Kod Düzenleyici", c);
      }
      function openTerminal() {
        const c = `<div class="terminal-content">GARNUS Terminal [Versiyon 1.0]<br></div><span style="color:lime">></span><input type="text" class="terminal-input">`;
        createWindow("Terminal", c, (w) => {
          const o = w.querySelector(".terminal-content");
          const i = w.querySelector("input");
          i.focus();
          i.addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
              const cmd = i.value.trim().toLowerCase();
              o.innerHTML += `> ${cmd}<br>`;
              if (cmd === "//guncelle") {
                o.innerHTML += "Güncellemeler denetleniyor...<br>";
                setTimeout(() => {
                  o.innerHTML +=
                    "Sisteminiz güncel. Yeni güncelleme bulunamadı.<br>";
                  o.scrollTop = o.scrollHeight;
                }, 2000);
              } else if (cmd === "yardim") {
                o.innerHTML +=
                  "Mevcut komutlar: yardim, tarih, temizle, //guncelle<br>";
              } else if (cmd === "tarih") {
                o.innerHTML += new Date().toLocaleString() + "<br>";
              } else if (cmd === "temizle") {
                o.innerHTML = "";
              } else {
                o.innerHTML += `Komut tanınmadı: ${cmd}<br>`;
              }
              i.value = "";
              o.scrollTop = o.scrollHeight;
            }
          });
        });
      }
      function openErrorTestApp() {
        const errors = Array.from({ length: 10 }, () => ({
          title:
            (Math.random() > 0.5
              ? "svchost.exe"
              : ["downloader.exe", "client.exe", "explorer.exe"][
                  Math.floor(Math.random() * 3)
                ]) + " - Application Error",
          iAddr: "0x" + Math.random().toString(16).slice(2, 14).toUpperCase(),
          mAddr: "0x" + Math.random().toString(16).slice(2, 14).toUpperCase(),
          action: ["read", "written", "executed"][
            Math.floor(Math.random() * 3)
          ],
        }));
        let currentIndex = 0;
        function showNextError() {
          if (currentIndex >= errors.length) return;
          const errorData = errors[currentIndex];
          const dialog = document.createElement("div");
          dialog.className = "error-dialog";
          dialog.style.left =
            Math.floor(Math.random() * (desktop.clientWidth - 450)) + "px";
          dialog.style.top =
            Math.floor(Math.random() * (desktop.clientHeight - 200)) + "px";
          dialog.innerHTML = `<div class="error-title-bar"><span>${errorData.title}</span><span>×</span></div><div class="error-content"><div class="error-icon">×</div><div class="error-text">The instruction at <b>${errorData.iAddr}</b> referenced memory at <b>${errorData.mAddr}</b>. The memory could not be <b>${errorData.action}</b>.<br><br>Click on OK to terminate the program</div></div><div class="error-footer"><button class="next-btn">OK</button></div>`;
          desktop.appendChild(dialog);
          makeElementDraggable(
            dialog,
            dialog.querySelector(".error-title-bar")
          );
          const okBtn = dialog.querySelector(".error-footer button");
          okBtn.focus();
          okBtn.onclick = () => {
            desktop.removeChild(dialog);
            currentIndex++;
            showNextError();
          };
        }
        showNextError();
      }
    </script>
  </body>
</html>
